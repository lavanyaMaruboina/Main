<template>
    <template if:true={isModalOpen}>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open  slds-modal_large">
            <div class="slds-modal__container">
                <header class="slds-modal__header" style="background: #8C3137;">
                    <button style="background-color: grey" class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                        <lightning-icon icon-name="utility:close"
                            alternative-text="close"
                            variant="inverse"
                            size="small" ></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <div>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate"
                         style="color: white;margin-block: -9px">
                            View Deviation
                        </h2>
                    </div>
                </header>
                <div class="slds-modal__content slds-p-around_medium slds-scrollable_x" style="overflow-y: auto;"
                    id="modal-content-id-1">
                    <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered"
                        style="border: groove;">
                        <thead>
                            <tr class="slds-line-height_reset">
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Source</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Type</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass centerClass slds-cell-wrap">Deviation ID</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Deviation Description</div>
                                </th>
                                <th lwc:if={istractor} class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Justification Remarks</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Role</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Deviation Level</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Approval Status</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Remarks</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="labelClass slds-cell-wrap">Source AppNo</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template for:each={deveiationResponse} for:item="item">
                               <tr class="slds-hint-parent" key={item}>
                                    <td data-label="Source">
                                        <div class="labelClass slds-cell-wrap">{item.Source}</div>
                                    </td>
                                    <td data-label="Type">
                                        <div class="labelClass slds-cell-wrap">{item.Type}</div>
                                    </td>
                                    <td data-label="Deviation ID">
                                        <div class="labelClass slds-cell-wrap">{item.DeviationID}</div>
                                    </td>
                                    <td data-label="Deviation Description">
                                        <div class="labelClass slds-cell-wrap">{item.DeviationDescription}</div>
                                    </td>
                                    <td lwc:if={istractor} data-label="Justification Remarks">
                                        <div  class="labelClass slds-cell-wrap">
                                            <lightning-input type="text" value={item.justificationRemarks} disabled={isDeviationTriggered} data-id={item.Id}
                                            variant="label-hidden" onchange={justificationhandler} max-length="1000" required=""></lightning-input>
                                        </div>
                                    </td>
                                    <td data-label="Role">
                                        <div class="labelClass slds-cell-wrap">{item.Role}</div>
                                    </td>
                                    <td data-label="Deviation Level">
                                        <div class="labelClass slds-cell-wrap">{item.DeviationLevel}</div>
                                    </td>
                                    <td data-label="Approval Status">
                                        <div class="labelClass slds-cell-wrap">{item.ApprovalStatus}</div>
                                    </td>
                                    <td data-label="Remarks">
                                        <div class="labelClass slds-cell-wrap">{item.Remarks}</div>
                                    </td>
                                    <td data-label="Source AppNo">
                                        <div class="labelClass slds-cell-wrap">{item.SourceAppNo}</div>
                                    </td>

                                </tr>
                            </template>
                        </tbody>
                    </table>
                    <button class="indusPrimaryVehicleButton slds-button slds-button_brand btnClass slds-m-top_small" disabled={isDeviationTriggered}
                        onclick={triggerDeviations}>
                        Trigger Deviations
                        <span  if:true={iconButton} class="slds-p-left_small">&#x2714;</span>
                    </button>
                </div>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open" style="height: 300vh !important;"></div>

    </template>
</template>